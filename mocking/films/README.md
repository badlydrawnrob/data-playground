# A basic film API

> Built from this [free film API](https://www.freepublicapis.com/free-movie-api)
> The `json` output is MASSIVE. How much of that could've been removed?!

1. `npx json-server film.db`
2. A `--watch` flag will update if `.db` does.
3. You can `GET` from `/films` url.
4. You can `POST` to `/films` url.[^1]
5. You can `GET` from `/films/:id` url.

Used [JQ Playground](https://play.jqlang.org/) to massage the API data (remove the `jq ''` part and change the `tt` id):

```bash
# get url: https://imdb.iamidiotareyoutoo.com/search?tt=tt20969586
# massage the data with jq: https://jqlang.org/tutorial/
>> jq '. | { title: .short.name, trailer: .short.trailer.embedUrl, summary: .short.description, tags: .short.genre }'

# post a film to json-server (currently `id` must be a string)
curl --request POST \
--url http://localhost:3000/films \
--header 'content-type: application/json' \
--data '{
  "id": "4",
  "title": "Nuovo Cinema Paradiso",
  "trailer": "https://www.imdb.com/video/vi2800655897/",
  "summary": "Salvatore, a famous film director, returns to his hometown for the funeral of the local theater&apos;s film projectionist, Alfredo. He reminisces about his life as a young boy falling in love with cinema.",
  "poster": null,
  "tags": [
    "Drama",
    "Romance"
  ],
  "reviews": null
}'
```

## Reviews

> We have two ways to grab a review:
> 1. Our `/films` endpoint contains reviews bound to a film
> 2. Our `/reviews` endpoint (read-only) mocks a review to use with ANY film

Here's [an example](https://www.rottentomatoes.com/m/thunderbolts/reviews?type=top_critics) of reviews and [how they're scored](https://www.rottentomatoes.com/about).

Rotten Tomatoes store reviews as `True` or `False` ([fresh or rotten](https://en.wikipedia.org/wiki/Rotten_Tomatoes#Critics'_aggregate_score)), but most
films will be reviewed with stars. Either they're converted from the original review into binary results, or the reviewer has an account and approximates their review themselves. There's also an [interesting comparison](https://www.pretentious-o-meter.co.uk/) between audience scores and critic's scores.

## `null` values

> If you don't need `null`, don't use it!

It's good to be explicit when a value doesn't exist, but `[]` empty lists are semantically _similar_ to a `null` (or in Elm `Nothing`) so just use them. Otherwise, consider using a `non-empty-list` type (so the `json` is always populated with a `[singleton]` or a list).

## Images

> Images don't have to be the same type, but it makes life easier if they are.

Rotten Tomatoes uses `.png`s and `.jpg`. If you try to save some they download as `ems.SOME-LONG-ID=` as they're generated by a `https://resizing.flixster.com/` API.

## Problems

> The server prefers `String` IDs. If you `POST` an entry it will automatically increment a `String` ID. If you've manually written `Int` IDs it'll convert to a string. If you don't supply an ID it'll generate a random string.

However, if you try to save a new entry with an `Int` id, it'll return a `Not Found` error](https://stackoverflow.com/a/77801181). I think this is something to do with urls technically being a string (even if a number). It's best to leave out the `ID` field and let json-server handle that.

## Tools

1. [Json Server](https://www.npmjs.com/package/json-server)
2. [Mockaroo](https://www.mockaroo.com/)
3. [JQ](https://developer.zendesk.com/documentation/integration-services/developer-guide/jq-cheat-sheet/)

[^1]: If no `"id"` is supplied, a random id will be generated.